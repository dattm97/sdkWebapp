(this.webpackJsonppaymesdk=this.webpackJsonppaymesdk||[]).push([[100],{122:function(n,e,t){"use strict";t.d(e,"a",(function(){return g})),t.d(e,"b",(function(){return S})),t.d(e,"d",(function(){return E})),t.d(e,"f",(function(){return w})),t.d(e,"e",(function(){return C})),t.d(e,"c",(function(){return P}));var a=t(105),o=t(106),i=t(184),c=t(143),s=t.n(c),r=t(144),l=t.n(r),d=t(96),u=t.n(d),p="APPROVED",m="REJECTED",f="CANCELED",v=t(43),b=(t(13),t(16)),k=t(25);var y=t(142),h=function(){function n(e,t){Object(a.a)(this,n),this._query="",this._socket={},this._callback=function(){},this._query=e,this._callback=t}return Object(o.a)(n,[{key:"initialSocketEvent",value:function(n){var e=this,t=v.b.getState(),a=t.ud.accessToken,o=t.sk,c=o.env,r=o.xApi,d="".concat(y.m);d="".concat("dev"===c?y.l:"sandbox"===c?y.n:"staging"===c?y.o:y.m),this._socket=new i.a("".concat(d,"/graphql"),{reconnect:!0,reconnectionAttempts:10,timeout:0,minTimeout:0,lazy:!0,connectionParams:{Authorization:a,"x-api-client":r},connectionCallback:function(n){n&&console.log("[PAYMESDK] - Socket GrapQL fail connection",n)}}),this._socket.on("connected",(function(){console.log("[PAYMESDK] - Socket GrapQL connected successfully")})),this._socket.on("disconnected",(function(){console.log("[PAYMESDK] - Socket GrapQL disconnected")})),this._socket.on("connecting",(function(){console.log("[PAYMESDK] - Socket GrapQL connecting")})),this._socket.on("reconnecting",(function(){console.log("[PAYMESDK] - Socket GrapQL reconnecting")})),this._socket.on("error",(function(){console.log("[PAYMESDK] - Socket GrapQL error")})),this._socket.on("reconnected",(function(){console.log("[PAYMESDK] - Socket GrapQL reconnected successfully")})),this._socket.request({query:this._query}).subscribe((function(t){if(t)if("dev"===c)n&&n(null===t||void 0===t?void 0:t.data),e._callback&&e._callback(null===t||void 0===t?void 0:t.data);else if(console.log("-----ResponseGrapQLDecrypt data",t),t["x-api-key"]&&t["x-api-message"]&&t["x-api-validate"]){var a=function(n,e,t){var a,o=v.b.getState(),i=o.ud.accessToken,c=o.sk.privateKey;try{var r=s.a.pki.privateKeyFromPem(c),d=s.a.util.decode64(n);a=r.decrypt(d,"RSA-OAEP")}catch(b){throw new Error('Th\xf4ng tin "x-api-key" kh\xf4ng ch\xednh x\xe1c')}var p={accessToken:i,"x-api-message":e},m=s.a.md.md5.create();if(m.update(l()(p).join("")+a),m.digest().toHex()!==t)throw new Error('Th\xf4ng tin "x-api-validate" kh\xf4ng ch\xednh x\xe1c');var f=null;try{f=JSON.parse(u.a.AES.decrypt(e,a).toString(u.a.enc.Utf8))}catch(k){throw new Error('Th\xf4ng tin "x-api-message" kh\xf4ng ch\xednh x\xe1c')}return f}(t["x-api-key"],t["x-api-message"],t["x-api-validate"]);n&&n(null===a||void 0===a?void 0:a.data),e._callback&&e._callback(null===a||void 0===a?void 0:a.data)}else n&&n(null===t||void 0===t?void 0:t.data),e._callback&&e._callback(null===t||void 0===t?void 0:t.data)}))}},{key:"closeSocket",value:function(){this._socket.close()}}]),n}(),g=(new h("subscription Subscription {\n  PaymeCredit {\n    ... on PaymeCreditRegisterSubscription {\n      state\n    }\n  }\n}",(function(n){var e,t,a,o,i,c;if((null===n||void 0===n||null===(e=n.PaymeCredit)||void 0===e?void 0:e.state)===p||(null===n||void 0===n||null===(t=n.PaymeCredit)||void 0===t?void 0:t.state)===m||(null===n||void 0===n||null===(a=n.PaymeCredit)||void 0===a?void 0:a.state)===f){switch(v.b.dispatch((i={},c=null,{api:function(){return Object(k.b)("mutation Mutation {\n    PaymeCredit {\n      CreditInfo {\n        succeeded\n        message\n        state\n        name\n        creditLimit\n        approvedAt\n        creditUsed\n        creditRemain\n        packageNumber\n        creditType\n        package {\n          id\n          name\n          creditLimit\n          interest\n          lateFee\n          withdrawFee\n          deferredInterest\n        }\n        supplier {\n          name\n          logo\n          detail {\n            name\n            shortName\n            showName\n            logo\n            description\n          }\n        }\n        paymentInfo {\n          dueDate\n          creditUsed\n          fee\n          total\n        }\n        display {\n          info {\n            color\n            format\n            text\n          }\n          label {\n            color\n            format\n            text\n          }\n        }\n      }\n    }\n  }",{})},type:b.L.CREDIT_INFO,showLoading:!1,payload:i,callback:c})),null===n||void 0===n||null===(o=n.PaymeCredit)||void 0===o?void 0:o.state){case p:v.b.dispatch({type:b.z,payload:!0});break;case m:v.b.dispatch({type:b.C,payload:!0})}window.location.replace("/")}})),new h("subscription Subscription {\n  AdvanceSalary {\n    ... on AdvanceSalaryStateSubscription {\n      advanceSalary {\n        id\n        merchantName\n        merchantId\n        state\n        amount\n        approvedAt\n        dueDate {\n          value\n          title\n        }\n        transaction\n        supplierTransaction\n        fee\n        total\n      }\n    }\n  }\n}")),S=(new h("subscription Subscription {\n  FastLoan {\n    ... on FastLoanStateSubscription {\n      fastLoan {\n        fastLoanId\n        accountId\n        transaction\n        state\n        details {\n          supplierInfo {\n            id\n            name\n            logo\n            title\n          }\n          packageId\n          state\n          transaction\n          amount\n          createdAt\n          approvedAt\n          accountId\n          total\n          termFee\n          dueDate\n          term\n          settlementDate\n          interestRate\n          interestTitle\n        }\n      }\n    }\n  }\n}"),new h("subscription Subscription {\n  Wallet {\n    ... on WalletBalanceChangedSubscription {\n      balance\n    }\n  }\n}",(function(n){console.log("dataaa balance",n),v.b.dispatch({type:"UPDATE_BALANCE",payload:n})}))),E=new h("subscription Subscription {\n  CreditCard {\n    ... on LinkedStatusSubscription {\n      message\n      linkedStatus: state\n      linkedId\n      issuer\n    }\n    ... on PaymentStatusSubscription {\n      message\n      serviceCode\n      state\n      transaction\n      amount\n      total\n      createdAt\n      fee\n    }\n  }\n}"),w=new h("subscription Subscription {\n  CreditCard {\n    ... on LinkedStatusSubscription {\n      message\n      state\n      linkedId\n      issuer\n    }\n  }\n}"),C=new h("subscription Subscription {\n  BankCardVN {\n    ... on LinkedBankCardSubscription {\n      linkedId\n      state\n      bankCode\n      swiftCode\n    }\n  }\n}"),P=new h("subscription {\n  OpenEWalletPayment {\n    ... on OpenEWalletPaymentStateSubscription {\n      message\n      state\n      serviceCode\n      transaction\n      accountId\n      amount\n      total\n      fee\n      appId\n      createdAt\n      method\n    }\n  }\n}")},836:function(n,e,t){"use strict";t.r(e);var a=t(27),o=t.n(a),i=t(0),c=t.n(i),s=t(122),r=t(11);e.default=function(n){var e=n.data,t=n.onClosePopupRoot,a=Object(i.useRef)(null),l=function(){t&&t()};return Object(i.useEffect)((function(){var n=function(n){var t;(null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.isSubmitted)&&(a.current=setTimeout((function(){l(),e.onManualQuery&&e.onManualQuery()}),15e3))};return window.addEventListener("message",n),function(){return window.removeEventListener("message",n)}}),[]),Object(i.useEffect)((function(){return setTimeout((function(){var n,e,t=document.getElementById("frame"),a=(null===t||void 0===t?void 0:t.contentDocument)||(null===t||void 0===t||null===(n=t.contentWindow)||void 0===n?void 0:n.document),o=null===a||void 0===a||null===(e=a.getElementsByTagName("form"))||void 0===e?void 0:e[0];o&&o.submit()}),300),s.f.initialSocketEvent((function(n){console.log("dataSubscriptionLinked",n),(null===a||void 0===a?void 0:a.current)&&clearTimeout(null===a||void 0===a?void 0:a.current),o()(n)>0&&(l(),e.onGotoResult&&e.onGotoResult(n))})),function(){s.f.closeSocket()}}),[]),c.a.createElement("div",{className:"PopupNotifyBottom__container"},c.a.createElement("div",{className:"PopupNotifyBottom"},c.a.createElement("div",{className:"PopupNotifyBottom__inner",style:{paddingBottom:30,height:"90%"}},c.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"space-between",marginBottom:8}},c.a.createElement("div",{style:{flex:1}}),c.a.createElement("div",{style:{flex:2,alignItems:"center"}},e.titleHeader&&c.a.createElement("p",{className:"font-semibold",style:{fontSize:17,color:"#000000",textAlign:"center"}},e.titleHeader)),c.a.createElement("div",{style:{display:"flex",flex:1,justifyContent:"flex-end",marginRight:15},onClick:l,onKeyPress:l},e.showClose&&c.a.createElement("img",{className:"iconClose",src:r.b.icSetClose16Px,alt:""}))),c.a.createElement("iframe",{title:"WebView",id:"frame",srcDoc:"<html><body>".concat(e.url,"</body></html>"),width:"100%",height:"100%",frameBorder:"0",allowFullScreen:!0}))))}}}]);