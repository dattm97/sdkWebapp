(this.webpackJsonppaymesdk=this.webpackJsonppaymesdk||[]).push([[105],{139:function(e,i,n){"use strict";n.d(i,"a",(function(){return t}));var t=["VNIBVNVX","ICBVVNVX"]},870:function(e,i,n){"use strict";n.r(i);var t=n(13),a=n(10),l=n(0),o=n.n(l),d=n(75),s=n(9),r=n(18),u=n(34),c=n.n(u),v=n(27),b=n.n(v),k=n(243),m=n.n(k),C=n(26),p=n.n(C),f=n(45),L=n(17),g=n(41),y=n(114),I=n(19),A=n(52),O=n(15),E=n(22),h=n(67),V=n(20),N=n(12),j=n(54),w=n(21),B=n(176),R=n(16),T=n(43),x=n(139),D=n(825),_={isEmpty:c.a,size:b.a};i.default=function(){var e,i=Object(d.useHistory)(),n=i.location,u=Object(s.b)(),c=Object(r.bindActionCreators)(f,u),v=Object(s.d)().getState().sk,b=Object(s.c)((function(e){var i;return null===e||void 0===e||null===(i=e.sk)||void 0===i?void 0:i.partner})),k=Object(l.useState)(""),C=Object(a.a)(k,2),M=C[0],S=C[1],P=Object(l.useState)(null),U=Object(a.a)(P,2),H=U[0],F=U[1],K=Object(l.useState)(""),Q=Object(a.a)(K,2),W=Q[0],Y=Q[1],z=Object(l.useState)(""),G=Object(a.a)(z,2),J=G[0],X=G[1],q=Object(l.useState)(""),Z=Object(a.a)(q,2),$=Z[0],ee=Z[1],ie=Object(l.useState)(1e4),ne=Object(a.a)(ie,2),te=ne[0],ae=ne[1],le=Object(l.useState)(I.a.buttonState.UNACTIVE),oe=Object(a.a)(le,2),de=oe[0],se=oe[1],re=j.a.getDepositLimit(),ue=Object(l.useRef)(null),ce=Object(l.useRef)(null),ve=Object(E.b)();function be(){if(_.isEmpty(M))A.b.next({message:N.a.IsecCreateMsgError5,isVisible:!0});else if("CREDIT_CARD"!==H.type&&_.isEmpty(J))A.b.next({message:N.a.ErrorInfoATMCardDeposit,isVisible:!0});else if("CREDIT_CARD"!==H.type&&Object(L.g)(te)<1e4)A.b.next({message:"".concat(N.a.linkedMiniumMoney," 10,000"),isVisible:!0});else{if("NAPAS"===(null===H||void 0===H?void 0:H.gateway)){if(Object(L.g)(te)<re.min)return void V.b.next({message:"".concat(N.a.limitMinBank," l\xe0 ").concat(Object(L.m)(re.min)," \u0111 "),isVisible:!0});if(Object(L.g)(te)>re.max)return void V.b.next({message:"".concat(N.a.limitMaxBank," l\xe0 ").concat(Object(L.m)(re.max)," \u0111"),isVisible:!0})}var e=Object(L.b)(J).toUpperCase();if("CREDIT_CARD"===H.type){var n={cardNumber:M.replace(/[^0-9]/g,""),expiredAt:W},a={cardNumber:M.replace(/[^0-9]/g,""),expiredAt:W,amount:1e3,cvv:$,redirectUrl:"".concat(window.location.origin,"/resultPaymentCredit/")};c.authCreditCard({authCreditCardInput:n},(function(e,n){var l,o;if(e)if(null===n||void 0===n||null===(l=n.CreditCardLink)||void 0===l||null===(o=l.AuthCreditCard)||void 0===o?void 0:o.succeeded){var d,s,r,v,b=function(e){c.bankLinkVerifyMasterCard({linkInput:e},(function(e,n){var t,a,l,o;if(e)if("REQUIRED_VERIFY"===(null===n||void 0===n||null===(t=n.CreditCardLink)||void 0===t||null===(a=t.Link)||void 0===a?void 0:a.state)){var d,s,r={type:"CREDIT_CARD",bank:H,card:{cardNumber:M.replace(/[^0-9]/g,""),issuedAt:W}};u({type:"ADD_BANK_INFO",payload:r}),h.c.next({isVisible:!0,type:h.b.PopupNotifyBottomLinkedCreditCardStatusWebview,data:{url:null===n||void 0===n||null===(d=n.CreditCardLink)||void 0===d||null===(s=d.Link)||void 0===s?void 0:s.html,onGotoResult:function(){i.push("/listLinkedBank/")},onManualQuery:function(){i.push("/listLinkedBank/")},showClose:!0}})}else if("OTP_RETRY_TIMES_OVER"===(null===n||void 0===n||null===(l=n.CreditCardLink)||void 0===l||null===(o=l.Link)||void 0===o?void 0:o.state)){var c,v;A.b.next({message:null===n||void 0===n||null===(c=n.CreditCardLink)||void 0===c||null===(v=c.Link)||void 0===v?void 0:v.message,isVisible:!0})}else{var b,k;A.b.next({message:null===n||void 0===n||null===(b=n.CreditCardLink)||void 0===b||null===(k=b.Link)||void 0===k?void 0:k.message,isVisible:!0})}}))};if(null===n||void 0===n||null===(d=n.CreditCardLink)||void 0===d||null===(s=d.AuthCreditCard)||void 0===s?void 0:s.isAuth)h.c.next({isVisible:!0,type:h.b.PopupNotifyBottomCreditWebviewHidden,data:{url:null===n||void 0===n||null===(r=n.CreditCardLink)||void 0===r||null===(v=r.AuthCreditCard)||void 0===v?void 0:v.html,showClose:!0,onSubmitDone:function(){var e,i;a=Object(t.a)(Object(t.a)({},a),{},{referenceId:null===n||void 0===n||null===(e=n.CreditCardLink)||void 0===e||null===(i=e.AuthCreditCard)||void 0===i?void 0:i.referenceId}),b(a)},onSubmitFail:function(){V.b.next({message:N.a.messageError2,isVisible:!0})}}});else a=Object(t.a)(Object(t.a)({},a),{},{redirectUrl:"".concat(window.location.origin,"/resultPaymentCredit/")}),b(a)}else{var k,m;V.b.next({message:null===n||void 0===n||null===(k=n.CreditCardLink)||void 0===k||null===(m=k.AuthCreditCard)||void 0===m?void 0:m.message,isVisible:!0})}}))}if("NAPAS"===H.gateway){var l={redirectUrl:m()(x.a,null===H||void 0===H?void 0:H.swiftCode)?"".concat(window.location.origin,"/resultLinkedBIDVATM/"):"".concat(window.location.origin,"/resultLinkedATM/"),linkType:"CARD",swiftCode:H.swiftCode,clientId:null===v||void 0===v?void 0:v.clientId,linkInfo:{card:{cardNumber:M.replace(/[^0-9]/g,""),cardHolder:e,issuedAt:Object(g.k)(W)}},amount:Object(L.g)(te),envName:"WebApp"};c.bankLinkVerify({linkInput:l},(function(n,t){var a,l,o,d;if(n)if("REQUIRED_VERIFY"===(null===t||void 0===t||null===(a=t.BankLink)||void 0===a||null===(l=a.Link)||void 0===l?void 0:l.state)){var s,r,c={bank:H,card:{cardNumber:M.replace(/[^0-9]/g,""),cardHolder:e,issuedAt:W}};if(u({type:"ADD_BANK_INFO",payload:c}),m()(x.a,null===H||void 0===H?void 0:H.swiftCode))if("WEB"===p()(null===b||void 0===b?void 0:b.type)){var v,k,C=URL.createObjectURL(new Blob([null===t||void 0===t||null===(v=t.BankLink)||void 0===v||null===(k=v.Link)||void 0===k?void 0:k.html],{type:"text/html"}));ue.current=window.open(C,"_blank","toolbar=yes,scrollbars=yes,resizable=yes,top=500,left=500,width=1200,height=1000"),ue.current||V.b.next({isVisible:!0,type:"warning",message:"Vui l\xf2ng cho ph\xe9p b\u1eadt c\u1eeda s\u1ed5 tr\xecnh duy\u1ec7t v\xe0 th\u1eed l\u1ea1i."})}else{var f,L;w.b.next({type:"showButtonCloseNapas",isShowButtonClose:!0}),B.b.next({data:null===t||void 0===t||null===(f=t.BankLink)||void 0===f||null===(L=f.Link)||void 0===L?void 0:L.html,isVisible:!0})}else h.c.next({isVisible:!0,type:h.b.PopupNotifyBottomLinkedATMWebview,data:{url:null===t||void 0===t||null===(s=t.BankLink)||void 0===s||null===(r=s.Link)||void 0===r?void 0:r.html,onGotoResult:function(){i.push("/listLinkedBank/")},onManualQuery:function(){i.push("/listLinkedBank/")},showClose:!0}})}else if("OTP_RETRY_TIMES_OVER"===(null===t||void 0===t||null===(o=t.BankLink)||void 0===o||null===(d=o.Link)||void 0===d?void 0:d.state)){var g,y;A.b.next({message:null===t||void 0===t||null===(g=t.BankLink)||void 0===g||null===(y=g.Link)||void 0===y?void 0:y.message,isVisible:!0})}else{var I,O;A.b.next({message:null===t||void 0===t||null===(I=t.BankLink)||void 0===I||null===(O=I.Link)||void 0===O?void 0:O.message,isVisible:!0})}}))}if("PVCBANK"===H.gateway||"VIETIN"===H.gateway){var o={linkType:"CARD",swiftCode:H.swiftCode,clientId:null===v||void 0===v?void 0:v.clientId,linkInfo:{card:{cardNumber:M.replace(/[^0-9]/g,""),cardHolder:e,issuedAt:Object(g.k)(W)}}};c.bankLinkVerify({linkInput:o},(function(n,t){var a,l,d,s;if(n)if("REQUIRED_OTP"===(null===t||void 0===t||null===(a=t.BankLink)||void 0===a||null===(l=a.Link)||void 0===l?void 0:l.state)){var r,c,v={bank:H,card:{cardNumber:M.replace(/[^0-9]/g,""),cardHolder:e,issuedAt:W}};u({type:"ADD_BANK_INFO",payload:v});var b={transactionId:null===t||void 0===t||null===(r=t.BankLink)||void 0===r||null===(c=r.Link)||void 0===c?void 0:c.transaction,bankInfo:H,swiftCode:H.swiftCode,cardItem:{cardNumber:M.replace(/[^0-9]/g,""),cardHolder:e,cardDate:W,issuedAt:Object(g.k)(W)}};i.push("/inputOTPBank",{paramsInput:b,linkInput:o})}else if("OTP_RETRY_TIMES_OVER"===(null===t||void 0===t||null===(d=t.BankLink)||void 0===d||null===(s=d.Link)||void 0===s?void 0:s.state)){var k,m;A.b.next({message:null===t||void 0===t||null===(k=t.BankLink)||void 0===k||null===(m=k.Link)||void 0===m?void 0:m.message,isVisible:!0})}else{var C,p;A.b.next({message:null===t||void 0===t||null===(C=t.BankLink)||void 0===C||null===(p=C.Link)||void 0===p?void 0:p.message,isVisible:!0})}}))}}}Object(l.useEffect)((function(){var e;F(null===n||void 0===n||null===(e=n.state)||void 0===e?void 0:e.ItemBank);var t=function(e){var n=e.key,t=e.newValue;"ResultLinkedATM"===n&&(localStorage.removeItem("ResultLinkedATM"),"onManualUpdate"===t&&(T.b.dispatch({type:R.x}),ce.current=setTimeout((function(){T.b.dispatch({type:R.o}),i.push("/listLinkedBank")}),15e3)))};return window.addEventListener("storage",t),function(){window.removeEventListener("storage",t)}}),[]);return o.a.createElement("div",{className:"InputInfoATMCard",style:{height:Object(O.a)().height-48-ve}},o.a.createElement("div",{className:"InputInfoATMCardInner"},o.a.createElement(y.a,{typeForm:"CREDIT_CARD"===(null===H||void 0===H?void 0:H.type)?"INTERNATIONAL_CARD":"LOCAL_CARD",onSelect:function(){return be()},listBank:null===n||void 0===n||null===(e=n.state)||void 0===e?void 0:e.ListBank,setCardNumber:S,setCardDate:Y,setCardHolder:X,setCardCVV:ee,bankInfo:H,onChangeBankCreditCard:function(e){F(D.listVisa.find((function(i){return(null===i||void 0===i?void 0:i.issuer)===e})))},checkActiveButton:function(e){return function(e){se(e?I.a.buttonState.ACTIVE:I.a.buttonState.UNACTIVE)}(e)}}),"NAPAS"===(null===H||void 0===H?void 0:H.gateway)?o.a.createElement("div",{className:"LayoutMoney"},o.a.createElement("div",{className:"TxtMoneyLayoutMoney"},"S\u1ed1 ti\u1ec1n n\u1ea1p (\u0111)"),o.a.createElement("div",null,o.a.createElement("input",{className:"InputCardMoney",type:"text",value:Object(L.m)(te),maxLength:12,onChange:function(e){var i,n;Object(L.g)(null===e||void 0===e||null===(i=e.target)||void 0===i?void 0:i.value)>re.max?ae(re.max):ae(null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.value)}})),o.a.createElement("div",{className:"TxtDescriptionLayoutMoney"},"(B\u1ea1n c\u1ea7n n\u1ea1p t\u1ed1i thi\u1ec3u 10.000\u0111 \u0111\u1ec3 \u0111\u01b0\u1ee3c li\xean k\u1ebft)")):null),o.a.createElement("div",{className:"fixBottom"},o.a.createElement(I.a,{className:"btn",label:"LI\xcaN K\u1ebeT",variant:de,disabled:de===I.a.buttonState.UNACTIVE,onClick:function(){return be()}})))}}}]);